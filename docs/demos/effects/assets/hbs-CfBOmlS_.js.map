{"version":3,"file":"hbs-CfBOmlS_.js","sources":["../../node_modules/.pnpm/ember-repl@6.0.0_0e39ae1ff3f8345ffd5a96b9918419c3/node_modules/ember-repl/dist/compile/formats/hbs.js"],"sourcesContent":["import { precompileJSON } from '@glimmer/compiler';\nimport { getTemplateLocals } from '@glimmer/syntax';\nimport { setComponentTemplate } from '@ember/component';\nimport _TO from '@ember/component/template-only';\nimport { array, concat, fn, get, hash } from '@ember/helper';\nimport { on } from '@ember/modifier';\nimport { createTemplateFactory } from '@ember/template-factory';\nimport { nameFor } from '../utils.js';\n\n// import { precompileJSON } from '@glimmer/compiler';\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\n// These things are pre-bundled in the old system.\n// ember-template-compiler defines them in AMD/requirejs\n/**\n * compile a template with an empty scope\n * to use components, helpers, etc, you will need to compile with JS\n *\n * (templates alone do not have a way to import / define complex structures)\n */\nfunction compileHBS(template, options = {}) {\n  const name = nameFor(template);\n  let component;\n  let error;\n  try {\n    component = setComponentTemplate(compileTemplate(template, {\n      moduleName: options.moduleName || name,\n      ...options\n    }), _TO(options.moduleName || name));\n  } catch (e) {\n    error = e;\n  }\n  return {\n    name,\n    component,\n    error\n  };\n}\n/**\n * The reason why we can't use precompile directly is because of this:\n * https://github.com/glimmerjs/glimmer-vm/blob/master/packages/%40glimmer/compiler/lib/compiler.ts#L132\n *\n * Support for dynamically compiling templates in strict mode doesn't seem to be fully their yet.\n * That JSON.stringify (and the lines after) prevent us from easily setting the scope function,\n * which means that *everything* is undefined.\n */\nfunction compileTemplate(source, {\n  moduleName,\n  scope = {}\n}) {\n  const localScope = {\n    array,\n    concat,\n    fn,\n    get,\n    hash,\n    on,\n    ...scope\n  };\n  const locals = getTemplateLocals(source);\n  const options = {\n    strictMode: true,\n    moduleName,\n    locals,\n    isProduction: false,\n    meta: {\n      moduleName\n    }\n  };\n\n  // Copied from @glimmer/compiler/lib/compiler#precompile\n  const [block, usedLocals] = precompileJSON(source, options);\n  const usedScope = usedLocals.map(key => {\n    const value = localScope[key];\n    if (!value) {\n      throw new Error(`Attempt to use ${key} in compiled hbs, but it was not available in scope. ` + `Available scope includes: ${Object.keys(localScope)}`);\n    }\n    return value;\n  });\n  const blockJSON = JSON.stringify(block);\n  const templateJSONObject = {\n    id: moduleName,\n    block: blockJSON,\n    moduleName: moduleName ?? '(dynamically compiled component)',\n    scope: () => usedScope,\n    isStrictMode: true\n  };\n  const factory = createTemplateFactory(templateJSONObject);\n  return factory;\n}\n\nexport { compileHBS };\n//# sourceMappingURL=hbs.js.map\n"],"names":["compileHBS","template","options","name","nameFor","component","error","setComponentTemplate","compileTemplate","moduleName","_TO","e","source","scope","localScope","array","concat","fn","get","hash","on","locals","getTemplateLocals","strictMode","isProduction","meta","block","usedLocals","precompileJSON","usedScope","map","key","value","Error","Object","keys","blockJSON","JSON","stringify","templateJSONObject","id","isStrictMode","factory","createTemplateFactory"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AAgBA;AACA;AACA;AACA;AACA;AACA;AACO,SAASA,UAAUA,CAACC,QAAgB,EAAEC,OAA+B,GAAG,EAAE,EAAiB;AAChG,EAAA,MAAMC,IAAI,GAAGC,OAAO,CAACH,QAAQ,CAAC;AAC9B,EAAA,IAAII,SAAoC;AACxC,EAAA,IAAIC,KAAwB;EAE5B,IAAI;AACFD,IAAAA,SAAS,GAAGE,oBAAoB,CAC9BC,eAAe,CAACP,QAAQ,EAAE;AAAEQ,MAAAA,UAAU,EAAEP,OAAO,CAACO,UAAU,IAAIN,IAAI;MAAE,GAAGD;KAAS,CAAC,EACjFQ,YAAqB,CAACR,OAAO,CAACO,UAAU,IAAIN,IAAI,CAClD,CAAkB;GACnB,CAAC,OAAOQ,CAAC,EAAE;AACVL,IAAAA,KAAK,GAAGK,CAAsB;AAChC,EAAA;EAEA,OAAO;IAAER,IAAI;IAAEE,SAAS;AAAEC,IAAAA;AAAO,GAAA;AACnC;AAUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASE,eAAeA,CAACI,MAAc,EAAE;EAAEH,UAAU;AAAEI,EAAAA,KAAK,GAAG;AAA2B,CAAC,EAAE;AAC3F,EAAA,MAAMC,UAAU,GAAG;IAAEC,KAAK;IAAEC,MAAM;IAAEC,EAAE;IAAEC,GAAG;IAAEC,IAAI;IAAEC,EAAE;IAAE,GAAGP;AAAc,GAAA;AACxE,EAAA,MAAMQ,MAAM,GAAGC,iBAAiB,CAACV,MAAM,CAAC;AAExC,EAAA,MAAMV,OAAO,GAAG;AACdqB,IAAAA,UAAU,EAAE,IAAI;IAChBd,UAAU;IACVY,MAAM;AACNG,IAAAA,YAAY,EAAE,KAAK;AACnBC,IAAAA,IAAI,EAAE;AAAEhB,MAAAA;AAAW;AACpB,GAAA;;AAED;EACA,MAAM,CAACiB,KAAK,EAAEC,UAAU,CAAC,GAAGC,cAAc,CAAChB,MAAM,EAAEV,OAAO,CAAC;AAE3D,EAAA,MAAM2B,SAAS,GAAGF,UAAU,CAACG,GAAG,CAAEC,GAAW,IAAK;AAChD,IAAA,MAAMC,KAAK,GAAGlB,UAAU,CAACiB,GAAG,CAAC;IAE7B,IAAI,CAACC,KAAK,EAAE;AACV,MAAA,MAAM,IAAIC,KAAK,CACb,CAAA,eAAA,EAAkBF,GAAG,CAAA,qDAAA,CAAuD,GAC1E,CAAA,0BAAA,EAA6BG,MAAM,CAACC,IAAI,CAACrB,UAAU,CAAC,EACxD,CAAC;AACH,IAAA;AAEA,IAAA,OAAOkB,KAAK;AACd,EAAA,CAAC,CAAC;AAEF,EAAA,MAAMI,SAAS,GAAGC,IAAI,CAACC,SAAS,CAACZ,KAAK,CAAC;AACvC,EAAA,MAAMa,kBAAkB,GAAG;AACzBC,IAAAA,EAAE,EAAE/B,UAAU;AACdiB,IAAAA,KAAK,EAAEU,SAAS;IAChB3B,UAAU,EAAEA,UAAU,IAAI,kCAAkC;IAC5DI,KAAK,EAAEA,MAAMgB,SAAS;AACtBY,IAAAA,YAAY,EAAE;AACf,GAAA;AAED,EAAA,MAAMC,OAAO,GAAGC,eAAqB,CAACJ,kBAAkB,CAAC;AAEzD,EAAA,OAAOG,OAAO;AAChB;;;;","x_google_ignoreList":[0]}